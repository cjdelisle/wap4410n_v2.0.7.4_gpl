<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" >
<html >
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="description" content="Cisco WAP4410N">
        <META http-equiv="Pragma" CONTENT="no-cache">
        <META HTTP-EQUIV="Cache-Control" CONTENT="no-cache">
        <meta http-equiv="Expires" content="-1">
        <script language="javascript" type="text/javascript" src="msg_@sys_lang#.js"></script>
        <script language="javascript" type="text/javascript" src="lang_@sys_lang#.js"></script>
        <script language="javascript" type="text/javascript" src="lang_jp1.js"></script>     
        <script language="javascript" type="text/javascript" src="func.js"></script>
        <script language="javascript" type="text/javascript" src="linux.js"></script>
        <script language="javascript" type="text/javascript">
            strHtml='<title>'+titl_lg+'</title>';
            dw(strHtml);
            strHtml='<LINK REL="stylesheet" TYPE="text/css" HREF="'+css_type+'">';
            dw(strHtml);

            var base64EncodeChars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
            var base64DecodeChars = new Array(
                    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
                    -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 62, -1, -1, -1, 63,
                    52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, -1, -1, -1,
                    -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14,
                    15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1,
                    -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
                    41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, -1, -1, -1, -1, -1);

function base64encode(str) {
    var out, i, len;
    var c1, c2, c3;

    len = str.length;
    i = 0;
    out = "";
    while(i < len) {
        c1 = str.charCodeAt(i++) & 0xff;
        if(i == len)
        {
            out += base64EncodeChars.charAt(c1 >> 2);
            out += base64EncodeChars.charAt((c1 & 0x3) << 4);
            out += "==";
            break;
        }
        c2 = str.charCodeAt(i++);
        if(i == len)
        {
            out += base64EncodeChars.charAt(c1 >> 2);
            out += base64EncodeChars.charAt(((c1 & 0x3)<< 4) | ((c2 & 0xF0) >> 4));
            out += base64EncodeChars.charAt((c2 & 0xF) << 2);
            out += "=";
            break;
        }
        c3 = str.charCodeAt(i++);
        out += base64EncodeChars.charAt(c1 >> 2);
        out += base64EncodeChars.charAt(((c1 & 0x3)<< 4) | ((c2 & 0xF0) >> 4));
        out += base64EncodeChars.charAt(((c2 & 0xF) << 2) | ((c3 & 0xC0) >>6));
        out += base64EncodeChars.charAt(c3 & 0x3F);
    }
    return out;
}

function base64decode(str) {
    var c1, c2, c3, c4;
    var i, len, out;

    len = str.length;
    i = 0;
    out = "";
    while(i < len) {
        /* c1 */
        do {
            c1 = base64DecodeChars[str.charCodeAt(i++) & 0xff];
        } while(i < len && c1 == -1);
        if(c1 == -1)
            break;

        /* c2 */
        do {
            c2 = base64DecodeChars[str.charCodeAt(i++) & 0xff];
        } while(i < len && c2 == -1);
        if(c2 == -1)
            break;

        out += String.fromCharCode((c1 << 2) | ((c2 & 0x30) >> 4));

        /* c3 */
        do {
            c3 = str.charCodeAt(i++) & 0xff;
            if(c3 == 61)
                return out;
            c3 = base64DecodeChars[c3];
        } while(i < len && c3 == -1);
        if(c3 == -1)
            break;

        out += String.fromCharCode(((c2 & 0XF) << 4) | ((c3 & 0x3C) >> 2));

        /* c4 */
        do {
            c4 = str.charCodeAt(i++) & 0xff;
            if(c4 == 61)
                return out;
            c4 = base64DecodeChars[c4];
        } while(i < len && c4 == -1);
        if(c4 == -1)
            break;
        out += String.fromCharCode(((c3 & 0x03) << 6) | c4);
    }
    return out;
}

var Login_PWD= null;
function get_cookies() 
{
    var fm = document.forms[0];

    cookie_name = "LoginName";
    Set_Cookie(cookie_name, "", expires);
    cookie_name = "LoginPWD";
    Set_Cookie(cookie_name, "", expires);

    fm.login_name.select();
    fm.login_name.focus();
}

var tag = "@r_no#";
function get_infomsg() {

    if( tag =="1"){
        document.getElementById('label1').style.display='block';
        document.getElementById('label2').style.display='none';
        document.getElementById('label3').style.display='none';
    }
    else if(tag =="2"){
        document.getElementById('label1').style.display='none';
        document.getElementById('label2').style.display='block';
        document.getElementById('label3').style.display='none';
    }
    else if ( tag =="3"){
        document.getElementById('label1').style.display='none';
        document.getElementById('label2').style.display='none';
        document.getElementById('label3').style.display='block';
    }
    else{
        document.getElementById('label1').style.display='none';
        document.getElementById('label2').style.display='none';
        document.getElementById('label3').style.display='none';
    }
}

function init()
{
    var cf = document.forms[0];

    cf.lang.selectedIndex = getSelIndex(cf.lang, cf.h_lang.value);
    PNGFix("LogoImage");
    get_cookies();
    get_infomsg();
    document.getElementById('progress1').style.display='block';
}

function checkPassword()
{
    var fm = document.forms[0];
    if (fm.login_pwd.value != fm.pw.value) {
        nlen = fm.login_pwd.value.toString().length;
        if (nlen>31) nlen = 31;
    }

}	  
var today = new Date();
var expires = new Date(today.getTime() + (32 *60 * 1000));
var nlen = 0;

function Set_Cookie(name,value,expires,path,domain,secure) 
{
    document.cookie = name + "=" +escape(value) +
        ( (expires) ? ";expires=" + expires.toGMTString() : "") +
        ( (path) ? ";path=" + path : "") + 
        ( (domain) ? ";domain=" + domain : "") +
        ( (secure) ? ";secure" : "");
}

function save_cookies() 
{
    var fm = document.forms[0];
    today = new Date();
    expires = new Date(today.getTime() + (32 * 60 * 1000));
    cookie_name = "LoginName";
    Set_Cookie(cookie_name, fm.un.value, expires);
    cookie_name = "LoginPWD";
    Set_Cookie(cookie_name, fm.pw.value, expires);
}

function acceptCheckIt(ok)
{
    btnclk=1;
    if (!eval(ok)) {
        top.location.href = "./index.htm";
        return false;
    }
    var fm = document.forms[0];
    var d = new Date();
    fm.time.value = d.getTime().toString().substring(4,13);
    name = fm.login_name.value; //stripSpace(fm.admin_id.value);
    pass = fm.login_pwd.value; //stripSpace(fm.admin_pw.value);
    if (   (name.length > 0) 
            && (pass.length > 0)
       ) { 
        fm.un.value=base64encode(name);
        if (pass != fm.pw.value) { // password changed
            fm.pw.value=base64encode(pass);

        } else {
            fm.pw.value=base64encode(pass.substring(0,nlen));
        }
        save_cookies();
        fm.login_name.value="";
        fm.login_pwd.value="";
        fm.submit();
    }
    else{
        document.getElementById('label1').style.display='none';
        document.getElementById('label2').style.display='none';
        document.getElementById('label3').style.display='block';
    }
    return false;
}

function readFile(url){
    var xmlhttp;
    if(window.ActiveXObject){
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }  
    if (!xmlhttp && typeof XMLHttpRequest != 'undefined') {
        try {
            xmlhttp = new XMLHttpRequest();
        } catch (e) {
            xmlhttp = false;
            alert('XHR error: ' + e);
        }
    }
    //url += '?timestamp='+ new Date().getTime();
    xmlhttp.open("GET",url,false);
    xmlhttp.send(null);
    return xmlhttp;
}

function setlanguage(lang)
{
    var file_name = 'setup.cgi?h_lang=' + lang + '&todo=save_lang&this_file=login.htm';
    var xmlhttp = readFile(file_name);
}

function setLanguage()
{
    cf = document.forms[0];
    cf.login_name.disabled = true;
    cf.login_pwd.disabled = true;
    cf.login.disabled = true;

//    setlanguage(cf.lang.options[cf.lang.selectedIndex].value);
    location.href='setup.cgi?h_lang=' + cf.lang.options[cf.lang.selectedIndex].value + '&todo=save_lang&this_file=login.htm'
//    window.location.reload();
}

function CheckIt() 
{       
    document.getElementById('progress1').style.display='block';
    acceptCheckIt(true);
}

function ctrlKeyEnter(evt) { 
    evt = (evt) ? evt : ((window.event) ? event : null); 
    if (evt) { 
        if (evt.keyCode==13) {
            CheckIt();
        } 
    } 
} 
</script>
</head>
<body onload="init();" >
      <form name="login" method="POST" action="./Home.htm" autocomplete="off"  onKeyDown="return ctrlKeyEnter(event);">
          <div class="MBackground">
              <img class="MBgImage" src="./pageBackground.jpg" title="" alt=""/></div>
          <table width="100%" height="100%" border=0 cellspacing=0 cellpadding=0 align="center" style="background-color:transparent; ">
              <tr style="height:20%">
                  <td width="10%" nowrap>&nbsp;</td>
                  <td width="93">&nbsp; </td>	
              </tr>
              <tr>
                  <td width="10%" nowrap>&nbsp;</td>
                  <td valign="top">
          <TABLE width="100%"  height="100%" border=0 cellspacing=0 cellpadding=0 style="background-color:transparent; ">
              <tr  >
              <td valign="top">	
          <TABLE width="100%" border=0 cellspacing=0 cellpadding=0  style="background-color:transparent; ">
              <tr>
                  <td valign="top">	
          <TABLE width="100%" border=0 cellspacing=0 cellpadding=0 style="background-color:transparent; " >
              <td valign="top" width="93px"> 
                  <br height="20px">
                  <img  id="LogoImage" src="./cisco_logo_about.png" title="Cisco" alt="Cisco"/>
              </td>
              <td width="320px"  valign="top"> 
                  <br height="20px">
                  <TABLE border=0 cellspacing=0 cellpadding=0  >
                      <tr style="height:10px;"><td></td> </tr>
                      <tr >
                          <td class="LoginBrandingName">&nbsp;</td>
                      </tr>
                      <tr>
                          <td class="LoginProductName">
                              <script language="javascript" type="text/javascript">dw(lg_name);</script>
                          </td>
                      </tr>
                  </table>
              </td>
              <td valign="top"> <br height="20px">
                  <TABLE border=0 cellspacing=0 cellpadding=0  >
                      <tr >
                          <td width="40px">&nbsp;</td> 
                          <td>&nbsp;</td>
                      </tr>
                  </table>
              </td>
          </tr>
          <tr>
              <td> &nbsp; </td>
              <td>
                  <br><br>
                  <div id="label1" style="display:none;" class="LoginInfo">
                      <TABLE border=0 cellspacing=0 cellpadding=0  >
                          <tr>
                              <td valign="top"  width="23px">
                                  <img  id="LogoInfo" src="./AlertInformation16Wht.gif" title="Info" />	
                              </td>
                              <td>
                                  <script language="javascript" type="text/javascript">dw(lg_logout);</script>
                              </td>
                          </tr>
                      </table>
                  </div>
                  <div id="label2" style="display:none;" class="LoginInfo">
                      <TABLE border=0 cellspacing=0 cellpadding=0  style="background-color:transparent; ">
                          <tr>
                              <td valign="top" width="23px">
                                  <img  id="LogoInfo" src="./AlertInformation16Wht.gif" title="Info" />	
                              </td>
                              <td>
                                  <script language="javascript" type="text/javascript">dw(lg_timeout);</script>
                              </td>
                      </tr></table>
                  </div>
              </td>
          </tr>
      </table>
  </td>
  <td align="right" valign="top">
      <TABLE border=0 cellspacing=0 cellpadding=0  >
          <tr colspan="2" height="43px" align="left"><td></td>
              <td>
                  <div id="label3" class="LoginError" style="display:none;">
                      <script language="javascript" type="text/javascript">dw(lg_pu);</script>
                      <img src="./ContextMessageArrow_DownT.gif" />	
                  </div>
              </td>
          </tr>

          <tr height="30px" valign="center" align="left">
              <td class="LoginField" valign="center"  width="65px">
                  <script language="javascript" type="text/javascript">dw(lg_uname);</script></td>
              <td  valign="center" >
                  <input type="text" class="num" name="login_name" size="23" maxlength="63" value="" style="margin-left:5px;" >
              </td>

          </tr>
          <tr height="30px" valign="center" align="left">
              <td class="LoginField" valign="center">
                  <script language="javascript" type="text/javascript">dw(lg_pwd);</script></td>
              <td  valign="center" >
                  <input type="password" class="num" name="login_pwd" size="23" maxlength="63" value="" style="margin-left:5px;" onChange="checkPassword();">
              </td>
          </tr>
          <tr height="30px" valign="center" align="left">
              <td class="LoginField" valign="center"  width="65px">
                  <script language="javascript" type="text/javascript">dw(lg_lang);</script></td>
              <td  valign="center" >
                  <select name="lang" class="SelectStd" style="margin-left:5px;" onChange="setLanguage();">
                      <option value="en"><script language="javascript" type="text/javascript">dw(lg_en);</script></option>
                      <option value="jp"><script language="javascript" type="text/javascript">dw(lg_jp);</script></option>
                  </select>
              </td>
          </tr>

          <tr height="30px" align="left">
              <td nowrap>&nbsp;</td>
              <td nowrap >
                  <div id="progress1" style="display:none;" >
                      <script language="javascript" type="text/javascript">
                          dw('<input type="button" style="margin-left:5px;" class="stdbutton" name="login" value="');
                          dw(lg_login);
                          dw('"  class="LoginButton" onClick="CheckIt();">');</script>
                  </div>
              </td>
          </tr>
          </table>
              </td>
          </tr>
      </table>
      </td>  	  
      <td width="10%" nowrap>&nbsp;</td>
  </tr>

      <tr colspan="2" valign="bottom" >
          <td valign="bottom"  >

              <div id="Copyright" class="Copyright" valign="bottom" >
                  <script language="javascript" type="text/javascript">dw(vcopyright);</script><br>
                  <script language="javascript" type="text/javascript">dw(vtrademark);</script>
              </div>
          </td>
      </tr>
  </table>
</div>
<INPUT type="hidden" name="time" VALUE="0">
<INPUT type="hidden" name="un" VALUE="">
<input type="hidden" name="pw" value="">
<input type="hidden" name="h_lang" value="@h_lang#">
<input type="hidden" name="this_file" value="login.htm">
<input type="hidden" name="next_file" value="Home.htm">
</form>
</body>
</html>
